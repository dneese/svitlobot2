<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–í–µ–± —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä –ø—Ä–æ—à–∏–≤–∫–∏ –°–≤—ñ—Ç–ª–æ–±–æ—Ç</title>
  <script type="module" src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 600px;
      width: 100%;
      padding: 40px;
    }

    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .form-group {
      margin-bottom: 25px;
    }

    label {
      display: block;
      color: #333;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 15px;
    }

    select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 15px;
      color: #333;
      background: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    select:hover {
      border-color: #667eea;
    }

    select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .install-section {
      margin-top: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 12px;
      text-align: center;
    }

    .install-section p {
      color: #555;
      margin-bottom: 15px;
      line-height: 1.6;
    }

    esp-web-install-button {
      --esp-tools-button-color: #667eea;
      --esp-tools-button-text-color: #ffffff;
      --esp-tools-button-border-radius: 10px;
    }

    .custom-install-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 18px;
      font-weight: 600;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .custom-install-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    .custom-install-btn:active {
      transform: translateY(0);
    }

    .warning {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin-top: 20px;
      border-radius: 8px;
      font-size: 13px;
      color: #856404;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 600px) {
      .container {
        padding: 25px;
      }
      
      h1 {
        font-size: 24px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚ö° –í–µ–±-—ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä –°–≤—ñ—Ç–ª–æ–±–æ—Ç</h1>
    <p class="subtitle">–ü—Ä–æ—à–∏–≤–∫–∞ –¥–ª—è ESP8266 —Ç–∞ ESP32</p>

    <div class="form-group">
      <label for="deviceSelect">1. –û–±–µ—Ä—ñ—Ç—å –≤–∞—à –ø—Ä–∏—Å—Ç—Ä—ñ–π:</label>
      <select id="deviceSelect">
        <option value="">-- –û–±–µ—Ä—ñ—Ç—å –ø—Ä–∏—Å—Ç—Ä—ñ–π --</option>
        <option value="wemos-d1-mini">Wemos D1 Mini (ESP8266)</option>
        <option value="esp32-wroom">ESP32 Wroom</option>
        <option value="esp32-c3-mini">ESP32-C3 Mini</option>
      </select>
    </div>

    <div class="form-group hidden" id="versionGroup">
      <label for="versionSelect">2. –û–±–µ—Ä—ñ—Ç—å –≤–µ—Ä—Å—ñ—é –ø—Ä–æ—à–∏–≤–∫–∏:</label>
      <select id="versionSelect">
        <option value="">-- –û–±–µ—Ä—ñ—Ç—å –≤–µ—Ä—Å—ñ—é --</option>
      </select>
    </div>

    <div class="install-section hidden" id="installSection">
      <p><strong>3. –ü—Ä–æ—à–∏–π—Ç–µ –ø—Ä–∏—Å—Ç—Ä—ñ–π:</strong></p>
      <p>–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å –ø—Ä–∏—Å—Ç—Ä—ñ–π —á–µ—Ä–µ–∑ USB-–∫–∞–±–µ–ª—å —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ.</p>
      
      <esp-web-install-button id="installBtn">
        <button slot="activate" class="custom-install-btn">üîß –ü—Ä–æ—à–∏—Ç–∏</button>
        <span slot="unsupported">–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ Chrome –∞–±–æ Edge.</span>
        <span slot="not-allowed">–ü–æ—Ç—Ä—ñ–±–µ–Ω HTTPS –¥–ª—è —Ä–æ–±–æ—Ç–∏ —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä–∞.</span>
      </esp-web-install-button>
    </div>

    <div class="warning">
      <strong>‚ö†Ô∏è –£–≤–∞–≥–∞:</strong> –ü—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –Ω–∞–¥–∞—î—Ç—å—Å—è –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç—ñ–π. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞ —Å–≤—ñ–π —Å—Ç—Ä–∞—Ö —ñ —Ä–∏–∑–∏–∫.
    </div>
  </div>

  <script>
    const deviceSelect = document.getElementById('deviceSelect');
    const versionSelect = document.getElementById('versionSelect');
    const versionGroup = document.getElementById('versionGroup');
    const installSection = document.getElementById('installSection');
    const installBtn = document.getElementById('installBtn');

    // –ú–∞–ø—ñ–Ω–≥ –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ —Ç–∞ –≤–µ—Ä—Å—ñ–π
    const devices = {
      'wemos-d1-mini': { 
        chipFamily: 'ESP8266', 
        name: 'Wemos D1 Mini',
        versions: ['v2.4', 'v2.6', 'v2.7.3','v2.7.5','v2.7.8','v2.7.8.1','v2.7','v2.7.9.1','v2.7.8','v2.8.0.1','v2.8.0.2','v2.8.0.3','v2.8.0.3.1','v2.8.0.4','v2.8.0.5'] 
      },
      'esp32-wroom': { 
        chipFamily: 'ESP32', 
        name: 'ESP32 Wroom',
        versions: ['v2.8.0.4', 'v2.8.0.5'] 
      },
      'esp32-c3-mini': { 
        chipFamily: 'ESP32-C3', 
        name: 'ESP32-C3 Mini',
        versions: ['v2.8.0.5'] 
      }
    };

    // –®–ª—è—Ö–∏ –¥–æ –ø—Ä–æ—à–∏–≤–æ–∫ (–∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ñ)
    const firmwarePaths = {
      'ESP8266': { 
        'v2.4': 'https://dneese.github.io/svitlobot2/svitlobot2.4.ino.nodemcu.bin', 
        'v2.6': 'https://dneese.github.io/svitlobot2/svitlobot2.6.nodemcu.bin',
        'v2.7.3': 'https://dneese.github.io/svitlobot2/svitlobot2.7.3.nodemcu.bin',
         'v2.7.5': 'https://dneese.github.io/svitlobot2/svitlobot2.7.5.+healthchecks_nodemcu.bin',
         'v2.7.8': 'https://dneese.github.io/svitlobot2/svitlobot2.7.8.esp8266.generic.bin',
         'v2.7.8.1': 'https://dneese.github.io/svitlobot2/svitlobot2.7.8.esp8266.nodemcuv2.bin' ,
         'v2.7': 'https://dneese.github.io/svitlobot2/svitlobot2.7.nodemcu.bin',   
         'v2.7.9.1': 'https://dneese.github.io/svitlobot2/svitlobot2_7_9_esp8266.generic.bin',   
         'v2.7.9': 'https://dneese.github.io/svitlobot2/svitlobot2_7_9_esp8266.nodemcuv2.bin', 
         'v2.7.8': 'https://dneese.github.io/svitlobot2/svitlobot2_8_0.esp8266.nodemcuv2.bin',  
         'v2.8.0.1': 'https://dneese.github.io/svitlobot2/svitlobot2_8_0_1.ino.bin',  
         'v2.8.0.2': 'https://dneese.github.io/svitlobot2/svitlobot2_8_0_2.esp8266.nodemcuv2.bin',  
         'v2.8.0.3': 'https://dneese.github.io/svitlobot2/svitlobot2_8_0_3.esp8266.nodemcuv2.bin',  
         'v2.8.0.3.1': 'https://dneese.github.io/svitlobot2/svitlobot2_8_0_3.noLed.bin',    
         'v2.8.0.4': 'https://dneese.github.io/svitlobot2/svitlobot2_8_0_4.ino.bin ',    
         'v2.8.0.5': 'https://dneese.github.io/svitlobot2/svitlobot2_8_0_5_esp8266.bin'    
  
           
      },
      'ESP32': { 
        'v2.8.0.4': 'https://dneese.github.io/svitlobot2/svitlobot2_esp32_2_8_0_4.ino.merged.bin',   
        'v2.8.0.5': 'https://dneese.github.io/svitlobot2/svitlobot2_esp32_2_8_0_5.bin'
        
      },
      'ESP32-C3': { 
      'v2.8.0.5': 'https://dneese.github.io/svitlobot2/svitlobot2_esp32c32_2_8_0_5.bin'
   
      }
    };

    // –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É –ø—Ä–∏—Å—Ç—Ä–æ—é
    deviceSelect.addEventListener('change', () => {
      const device = deviceSelect.value;
      versionSelect.innerHTML = '<option value="">-- –û–±–µ—Ä—ñ—Ç—å –≤–µ—Ä—Å—ñ—é --</option>';
      
      if (device) {
        versionGroup.classList.remove('hidden');
        devices[device].versions.forEach(v => {
          const option = document.createElement('option');
          option.value = v;
          option.textContent = `–í–µ—Ä—Å—ñ—è ${v}`;
          versionSelect.appendChild(option);
        });
        installSection.classList.add('hidden');
      } else {
        versionGroup.classList.add('hidden');
        installSection.classList.add('hidden');
      }
    });

    // –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É –≤–µ—Ä—Å—ñ—ó
    versionSelect.addEventListener('change', () => {
      const device = deviceSelect.value;
      const version = versionSelect.value;
      
      if (device && version) {
        const deviceInfo = devices[device];
        const chipFamily = deviceInfo.chipFamily;
        const path = firmwarePaths[chipFamily][version];
        
        // –ì–µ–Ω–µ—Ä—É—î–º–æ –º–∞–Ω—ñ—Ñ–µ—Å—Ç
        const manifest = {
          name: `Svitlobot ${version} –¥–ª—è ${deviceInfo.name}`,
          version: version,
          new_install_prompt_erase: true,
          builds: [
            {
              chipFamily: chipFamily,
              parts: [{ path: path, offset: 0 }]
            }
          ]
        };
        
        const blob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
        installBtn.manifest = URL.createObjectURL(blob);
        installSection.classList.remove('hidden');
      }
    });
  </script>
</body>
</html>
